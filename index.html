<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Form To Google Sheets Demo</title>
  <meta name="description" content="Store HTML form submissions in Google Sheets">
  <link href="./favicon.png" rel="shortcut icon">

  <link rel="stylesheet" href="main.css">
  <script src="https://unpkg.com/prefixfree@1.0.0/prefixfree.min.js"></script>  
</head>
<form name="submit-to-google-sheet">
  <input type="date" id="timestamp" name="timestamp">
  <input name="description" type="text" placeholder="Description" required>
  <input name="amount" type="text" placeholder="Amount">
  <select name="category" id="category">
    <option disabled selected value>--</option>
    <option value='Accessories'>Accessories</option>
    <option value='Auto'>Auto</option>
    <option value='Bike'>Bike</option>
    <option value='Biscuits'>Biscuits</option>
    <option value='Cake'>Cake</option>
    <option value='Cash Contra'>Cash Contra</option>
    <option value='Chit'>Chit</option>
    <option value='Dress'>Dress</option>
    <option value='Eat Out'>Eat Out</option>
    <option value='Eggs'>Eggs</option>
    <option value='Electrical'>Electrical</option>
    <option value='Electricity'>Electricity</option>
    <option value='Entertainment'>Entertainment</option>
    <option value='Essentials'>Essentials</option>
    <option value='Events'>Events</option>
    <option value='Exam fees'>Exam fees</option>
    <option value='Fancy Jewel'>Fancy Jewel</option>
    <option value='Fish'>Fish</option>
    <option value='Footwear'>Footwear</option>
    <option value='Fruits'>Fruits</option>
    <option value='Fund'>Fund</option>
    <option value='Giveaway'>Giveaway</option>
    <option value='Grinding'>Grinding</option>
    <option value='Groceries'>Groceries</option>
    <option value='Hair'>Hair</option>
    <option value='Household'>Household</option>
    <option value='Jewel'>Jewel</option>
    <option value='Loan'>Loan</option>
    <option value='Meat'>Meat</option>
    <option value='Medicine'>Medicine</option>
    <option value='Milk'>Milk</option>
    <option value='Other Expenses'>Other Expenses</option>
    <option value='Parking'>Parking</option>
    <option value='Petrol'>Petrol</option>
    <option value='PhotoCopy'>PhotoCopy</option>
    <option value='Pooja'>Pooja</option>
    <option value='Recharge'>Recharge</option>
    <option value='Return'>Return</option>
    <option value='School'>School</option>
    <option value='Shopping'>Shopping</option>
    <option value='Snacks'>Snacks</option>
    <option value='Stationary'>Stationary</option>
    <option value='Stiching'>Stiching</option>
    <option value='Toys'>Toys</option>
    <option value='Transportation'>Transportation</option>
    <option value='TV'>TV</option>
    <option value='Vegetables'>Vegetables</option>
  </select>
  <button type="submit">Send</button>
</form>

<script>
  const scriptURL = 'https://script.google.com/macros/s/AKfycbxyCTAX6LfdL0hiwPgVQxg2Ir4Z35l6Kw-HetwSJvzZMVONGGL-soLUYrpW4PgmblDA/exec'
  const form = document.forms['submit-to-google-sheet']

  window.onload= function(){
    document.getElementById('timestamp').value=(new Date()).toISOString().substr(0,10));
  }
  form.addEventListener('submit', e => {
    e.preventDefault()
    fetch(scriptURL, { method: 'POST', body: new FormData(form)})
      .then(response => { console.log('Success!', response);form.reset()})
      .catch(error => console.error('Error!', error.message))
  })
</script>
